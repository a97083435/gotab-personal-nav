import{c as e,an as t,F as s,r as a,j as r,w as l,av as n,B as i,aw as o,aa as c,O as m,a0 as d,ap as h,aq as x,E as f,N as j,ax as y,a8 as p,e as u,D as _,C as b,H as g,am as w}from"./main-nnl5as90.js";import{r as S}from"./transformData-BJjS5oj7.js";import{M as C,R as k}from"./myTable-Bn5N1pKu.js";import{C as N}from"./contentLayout-ETVvee1r.js";import{R as F}from"./SortAscendingOutlined-BSfDFGm-.js";import"./MoneyCollectOutlined-utZlhYCf.js";import"./AlipayOutlined-OwBpAKmB.js";import"./index-cXBAUQiq.js";function v(){const j=e.c(41),{key:y,refresh:p}=t(),[u]=s.useForm();let _;j[0]===Symbol.for("react.memo_cache_sentinel")?(_={},j[0]=_):_=j[0];const[b,g]=a.useState(_);let w,k,F,v;j[1]===Symbol.for("react.memo_cache_sentinel")?(w={title:"分类名称",key:"name",width:160},k={title:"排序",key:"sort",width:80,render:I},F={title:"更新时间",key:"updatedTime",width:200,render:T},j[1]=w,j[2]=k,j[3]=F):(w=j[1],k=j[2],F=j[3]),j[4]!==p?(v=[w,k,F,{title:"操作",fixed:"right",width:120,render:(e,t)=>r.jsx(O,{record:t,refresh:p})}],j[4]=p,j[5]=v):v=j[5];const W=v;let q,A,L,R,z,D,K,V,B,E,H,P,U,Y,$,G,J;return j[6]!==u?(q=()=>{const e=u.getFieldsValue();e[Math.random()]=!0,g(S(e))},j[6]=u,j[7]=q):q=j[7],j[8]===Symbol.for("react.memo_cache_sentinel")?(A={gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gridAutoRows:"32px"},j[8]=A):A=j[8],j[9]===Symbol.for("react.memo_cache_sentinel")?(L=r.jsx("div",{className:"gap-3 flex-wrap grid w-full mb-3",style:A,children:r.jsx(s.Item,{name:"name",children:r.jsx(l,{placeholder:"分类名称"})})}),j[9]=L):L=j[9],j[10]!==u?(R=()=>{u.submit()},j[10]=u,j[11]=R):R=j[11],j[12]===Symbol.for("react.memo_cache_sentinel")?(z=r.jsx(n,{}),j[12]=z):z=j[12],j[13]!==R?(D=r.jsx(i,{type:"primary",onClick:R,icon:z,children:"查询"}),j[13]=R,j[14]=D):D=j[14],j[15]!==u?(K=()=>{u.resetFields();const e={};e[Math.random()]=!0,g(e)},j[15]=u,j[16]=K):K=j[16],j[17]===Symbol.for("react.memo_cache_sentinel")?(V=r.jsx(o,{}),j[17]=V):V=j[17],j[18]!==K?(B=r.jsx(i,{onClick:K,icon:V,children:"重置"}),j[18]=K,j[19]=B):B=j[19],j[20]!==D||j[21]!==B?(E=r.jsxs("div",{className:"flex flex-wrap gap-3",children:[D,B]}),j[20]=D,j[21]=B,j[22]=E):E=j[22],j[23]!==u||j[24]!==E||j[25]!==q?(H=r.jsxs(s,{className:"w-full",form:u,onFinish:q,children:[L,E]}),j[23]=u,j[24]=E,j[25]=q,j[26]=H):H=j[26],j[27]===Symbol.for("react.memo_cache_sentinel")?(P=r.jsx(c,{type:"warning",description:r.jsxs(r.Fragment,{children:[r.jsx(m,{className:"mr-1"}),"收录分类在前端获取列表时做了 10 分钟的缓存效果，可能存在数据不及时更新情况，请重启或等待缓存失效"]}),className:"mt-3 p-1 px-3 text-xs font-normal w-full"}),U=r.jsx(d,{className:"my-3"}),j[27]=P,j[28]=U):(P=j[27],U=j[28]),j[29]!==p?(Y=r.jsx("div",{className:"mb-3",children:r.jsx(i,{type:"primary",onClick:()=>{h.show(x,{title:"新增分类",children:r.jsx(M,{refresh:p,type:"add"})})},children:"新增分类"})}),j[29]=p,j[30]=Y):Y=j[30],j[31]!==b?($={searchParams:b},j[31]=b,j[32]=$):$=j[32],j[33]!==W||j[34]!==y||j[35]!==$?(G=r.jsx(C,{columns:W,getListUrl:f.getWebsiteCategoryList,dataKey:"data.list",tableKey:y,params:$}),j[33]=W,j[34]=y,j[35]=$,j[36]=G):G=j[36],j[37]!==H||j[38]!==Y||j[39]!==G?(J=r.jsxs(N,{children:[H,P,U,Y,G]}),j[37]=H,j[38]=Y,j[39]=G,j[40]=J):J=j[40],J}function T(e,t){return r.jsx(j,{icon:r.jsx(y,{}),children:e||t.createdTime})}function I(e){return r.jsx(j,{color:"gold",icon:r.jsx(F,{}),children:e||"-"})}const M=t=>{const n=e.c(16),{editItem:o,refresh:c,type:m}=t,d=void 0===m?"add":m,[j]=s.useForm(),[y,b]=a.useState(!1);let g;n[0]!==o||n[1]!==c||n[2]!==d?(g=function(e){b(!0);const t=u.getState().user.token;_({url:"add"===d?f.addWebsiteCategory:f.editWebsiteCategory,token:t,data:"add"===d?e:{...e,id:o.id}}).then(e=>{200===e?.code&&(h.hide(x),c&&c())}).finally(()=>{b(!1)})},n[0]=o,n[1]=c,n[2]=d,n[3]=g):g=n[3];const w=g;let S,C,k,N;n[4]===Symbol.for("react.memo_cache_sentinel")?(S={flex:"82px"},n[4]=S):S=n[4],n[5]===Symbol.for("react.memo_cache_sentinel")?(C=r.jsx(s.Item,{name:"name",label:"分类名称",required:!0,rules:[{required:!0}],children:r.jsx(l,{placeholder:"分类名称",allowClear:!0})}),n[5]=C):C=n[5],n[6]===Symbol.for("react.memo_cache_sentinel")?(k=r.jsx(s.Item,{name:"sort",label:"排序",children:r.jsx(p,{placeholder:"排序"})}),n[6]=k):k=n[6],n[7]===Symbol.for("react.memo_cache_sentinel")?(N=r.jsx(i,{onClick:W,children:"取消"}),n[7]=N):N=n[7];const F="add"===d?"新增分类":"保存编辑";let v,T;return n[8]!==y||n[9]!==F?(v=r.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[N,r.jsx(i,{type:"primary",htmlType:"submit",loading:y,children:F})]}),n[8]=y,n[9]=F,n[10]=v):v=n[10],n[11]!==o||n[12]!==j||n[13]!==w||n[14]!==v?(T=r.jsx(r.Fragment,{children:r.jsxs(s,{form:j,autoComplete:"off",variant:"filled",initialValues:o,labelCol:S,onFinish:w,children:[C,k,v]})}),n[11]=o,n[12]=j,n[13]=w,n[14]=v,n[15]=T):T=n[15],T},O=a.memo(t=>{const s=e.c(20),{record:l,refresh:n}=t;let o;s[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],s[0]=o):o=s[0];const[c,m]=a.useState(o);let d;s[1]!==l||s[2]!==n?(d=function(){b(1,m);const e=u.getState().user.token;setTimeout(()=>{_({url:f.deleteWebsiteCategory,token:e,data:{id:l.id}}).then(e=>{200===e?.code&&n()}).finally(()=>{g(1,m)})},500)},s[1]=l,s[2]=n,s[3]=d):d=s[3];const j=d;let y,p,S,C,N,F,v;return s[4]===Symbol.for("react.memo_cache_sentinel")?(y={width:"44px"},s[4]=y):y=s[4],s[5]!==l||s[6]!==n?(p=r.jsx(i,{type:"link",size:"small",style:y,onClick:()=>{h.show(x,{title:"编辑分类",children:r.jsx(M,{editItem:l,refresh:n,type:"edit"})})},children:"编辑"}),s[5]=l,s[6]=n,s[7]=p):p=s[7],s[8]===Symbol.for("react.memo_cache_sentinel")?(S={width:"44px"},s[8]=S):S=s[8],s[9]!==c[1]?(C=c[1]?r.jsx(k,{}):"删除",s[9]=c[1],s[10]=C):C=s[10],s[11]!==c[1]||s[12]!==C?(N=r.jsx(i,{danger:!0,type:"link",size:"small",disabled:c[1],style:S,children:C}),s[11]=c[1],s[12]=C,s[13]=N):N=s[13],s[14]!==j||s[15]!==N?(F=r.jsx(w,{title:"是否确认删除？",onConfirm:j,children:N}),s[14]=j,s[15]=N,s[16]=F):F=s[16],s[17]!==p||s[18]!==F?(v=r.jsxs("div",{className:"flex flex-wrap",children:[p,F]}),s[17]=p,s[18]=F,s[19]=v):v=s[19],v});function W(){h.hide(x)}export{v as default};
